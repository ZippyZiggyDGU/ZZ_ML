## ğŸ“– ëª©ì°¨

- [ì„¤ëª…(Description)](#-ì„¤ëª…description)  
- [êµ¬ì„± ìš”ì†Œ(Components)](#-êµ¬ì„±-ìš”ì†Œcomponents)  
- [ì„¤ì¹˜(Installation)](#-ì„¤ì¹˜installation)  
- [ì‚¬ìš©ë²•(Usage)](#-ì‚¬ìš©ë²•usage)
- [í”¼ì²˜ ì„¤ëª…(Feature Descriptions)](#-í”¼ì²˜-ì„¤ëª…feature-descriptions)  
- [ì¶œë ¥(Output)](#-ì¶œë ¥output)  
 

---

## ğŸ“„ ì„¤ëª… (Description)

ì´ í”„ë¡œì íŠ¸ëŠ” í™˜ìì˜ ê±´ê°•ê²€ì§„ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‹¬ë°©ì„¸ë™(AF) ë°œìƒ ì—¬ë¶€ë¥¼ ì˜ˆì¸¡í•˜ê¸° ìœ„í•œ ë¨¸ì‹ ëŸ¬ë‹ íŒŒì´í”„ë¼ì¸ì„ ì œê³µ  
- ê²°ì¸¡ì¹˜ ëŒ€ì²´ ë° í‘œì¤€í™” ì „ì²˜ë¦¬
- XGBoost ë¶„ë¥˜ê¸° í•™ìŠµ  
- ì „ì²´ íŒŒì´í”„ë¼ì¸ ONNX í˜•ì‹ìœ¼ë¡œ ë³€í™˜  


---

## ğŸ—ï¸ êµ¬ì„± ìš”ì†Œ (Components)

1. **`preprocessor.joblib`**  
   - `SimpleImputer(mean)` + `StandardScaler`ë¥¼ ì ìš©í•˜ëŠ” ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸  
2. **`xgb_model.joblib`**  
   - `XGBClassifier(eval_metric='logloss', random_state=42)` ëª¨ë¸ íŒŒì¼  
3. **`reduced_pipeline.onnx`**  
   - ì „ì²˜ë¦¬ + ë¶„ë¥˜ê¸° ì „ì²´ë¥¼ í¬í•¨í•˜ëŠ” ONNX íŒŒì´í”„ë¼ì¸  


---

## âš™ï¸ ì„¤ì¹˜ (Installation)

```bash
# ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/ZippyZiggyDGU/ZZ_ML.git

# ê°€ìƒí™˜ê²½ ìƒì„± & í™œì„±í™”
python -m venv venv
source venv/bin/activate  # macOS/Linux
venv\Scripts\activate     # Windows

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt
```

---

## ğŸš€ ì‚¬ìš©ë²• (Usage)

ì‹¬ë°©ì„¸ë™(AF) ëª¨ë¸ ONNX íŒŒì´í”„ë¼ì¸(`reduced_pipeline.onnx`) ì‚¬ìš©ë²•


---

### 1) ONNX íŒŒì´í”„ë¼ì¸ í…ŒìŠ¤íŠ¸ (`test.py`)

1. **`test.py` ìŠ¤í¬ë¦½íŠ¸ ìœ„ì¹˜ í™•ì¸**  
   í”„ë¡œì íŠ¸ ìµœìƒìœ„ì— ìœ„ì¹˜í•œ `test.py`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ONNX ëŸ°íƒ€ì„ì„ ì´ìš©í•´ ëª¨ë¸ì„ ë¡œë“œí•˜ê³ , ìƒ˜í”Œ ì…ë ¥ê°’ìœ¼ë¡œ ì¶”ë¡ ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

2. **ìƒ˜í”Œ ì…ë ¥ê°’**  
   - ìˆœì„œ: `age`, `ASBP`, `sex`, `exam1 age`, `smoke`, `PRSice2`  
   - ì˜ˆì‹œ: `66, 160, 1, 50, 0, -0.002517568`

3. **ì¶”ë¡  ì ˆì°¨**  
   - `InferenceSession`ìœ¼ë¡œ ONNX ëª¨ë¸ì„ ë¡œë“œí•©ë‹ˆë‹¤.  
   - ëŸ°íƒ€ì„ì—ì„œ ìš”êµ¬í•˜ëŠ” ì…ë ¥ í…ì„œ ì´ë¦„ê³¼ í˜•íƒœ(ì˜ˆ: `[None, 6]`)ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.  
   - NumPy ë°°ì—´ë¡œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ì¤€ë¹„í•œ ë’¤, `sess.run()`ì— ì „ë‹¬í•´ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.  
   - `outputs[0]`ì—ëŠ” ì˜ˆì¸¡ ë¼ë²¨(`0`: ë¹„ë°œìƒ, `1`: ë°œìƒ), `outputs[1]`ì—ëŠ” í´ë˜ìŠ¤ë³„ í™•ë¥  ë°°ì—´(`[P(AF=0), P(AF=1)]`)ì´ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤.

4. **ì‹¤í–‰ ë°©ë²•**  
   ```bash
   python test.py
   ```

   
---

## ğŸ¡ í”¼ì²˜ ì„¤ëª…(Feature Descriptions)


1. **age**: í™˜ìì˜ ì‹¤ì œ ë‚˜ì´  
2. **ASBP**: ìˆ˜ì¶•ê¸° í˜ˆì••(ìµœê³  í˜ˆì••) ìˆ˜ì¹˜  
   - ìµœì €ê°’ (min): 85.0  
   - ìµœëŒ€ê°’ (max): 191.0  
   - í‰ê·  (mean): 121.261  
   - ì¤‘ì•™ê°’ (median): 120.4  
   - í‘œì¤€í¸ì°¨ (std): 13.999  
   - ë¶„ì‚° (var): 195.985  

3. **sex**: ì„±ë³„ (1=ë‚¨ì„±, 0=ì—¬ì„±)  
4. **exam1 age**: ì²« ê²€ì§„ ì‹œ ë‚˜ì´ ê¸°ë¡  
5. **smoke**: í¡ì—° ì—¬ë¶€ (1=í¡ì—°, 0=ë¹„í¡ì—°)  
6. **PRSice2**: Polygenic Risk Score (ìœ ì „ìœ„í—˜ ì ìˆ˜)  
   - ìµœì €ê°’ (min): -0.002836  
   - ìµœëŒ€ê°’ (max): -0.002481  
   - í‰ê·  (mean): -0.002659  
   - ì¤‘ì•™ê°’ (median): -0.002660  
   - í‘œì¤€í¸ì°¨ (std): 0.000045 
   - ë¶„ì‚°(var) : 0.00000000203


---

## ğŸ–¨ï¸ ì¶œë ¥(ì˜ˆì‹œ)
```bash
Input name: float_input, expected shape: [None,6]
Predicted label: 1
Predicted probabilities: [0.72 0.28]
```

